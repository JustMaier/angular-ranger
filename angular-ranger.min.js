function PointerDraw(e,n,t,a,r){function i(e){if(Object.keys)return Object.keys(e).length;var n=0;for(var t in e)++n;return n}function o(e){e.preventDefault&&e.preventDefault(),e.preventManipulation&&e.preventManipulation(),e.preventMouseEvent&&e.preventMouseEvent()}function u(e){for(var n=0,t=0,a=e;null!=a;a=a.offsetParent)navigator.userAgent.match(/\bMSIE\b/)&&(!document.documentMode||document.documentMode<8)&&"relative"==a.currentStyle.position&&a.offsetParent&&"relative"==a.offsetParent.currentStyle.position&&a.offsetLeft==a.offsetParent.offsetLeft?t+=a.offsetTop:(n+=a.offsetLeft,t+=a.offsetTop);return{x:n,y:t}}function m(n){if("undefined"==typeof n.pageX)if(n.pageX=n.offsetX+f.x,n.pageY=n.offsetY+f.y,n.srcElement.offsetParent==e&&document.documentMode&&8==document.documentMode&&"mousedown"==n.type)n.pageX+=n.srcElement.offsetLeft,n.pageY+=n.srcElement.offsetTop;else if(n.srcElement!=e&&!document.documentMode||document.documentMode<8){for(var t=-2,a=-2,r=n.srcElement;null!=r;r=r.parentNode)t+=r.scrollLeft?r.scrollLeft:0,a+=r.scrollTop?r.scrollTop:0;n.pageX=n.clientX+t,n.pageY=n.clientY+a}}function l(n){return Math.max(0,Math.min(n-f.x,e.offsetWidth))}function s(n){return Math.max(0,Math.min(n-f.y,e.offsetHeight))}function c(p){if("mousemove"!=p.type||0!=i(d)){o(p);for(var h=p.changedTouches?p.changedTouches:[p],g=0;g<h.length;++g){var x=h[g],w="undefined"!=typeof x.identifier?x.identifier:"undefined"!=typeof x.pointerId?x.pointerId:1;m(x);var y=x.pageX,E=x.pageY;p.type.match(/(start|down)$/i)?(f=u(e),d[w]&&(a&&a(e,w),delete d[w],r&&r("Ended draw on pointer "+w+" in "+p.type)),n&&n(e,w,l(y),s(E)),d[w]={x:y,y:E},e.msSetPointerCapture?e.msSetPointerCapture(w):"mousedown"==p.type&&1==i(d)&&(v?e.setCapture(!0):(document.addEventListener("mousemove",c,!1),document.addEventListener("mouseup",c,!1)))):p.type.match(/move$/i)?!d[w]||d[w].x==y&&d[w].y==E||(t&&t(e,w,l(y),s(E)),d[w].x=y,d[w].y=E):d[w]&&p.type.match(/(up|end|cancel)$/i)&&(a&&a(e,w),delete d[w],e.msReleasePointerCapture?e.msReleasePointerCapture(w):"mouseup"==p.type&&0==i(d)&&(v?e.releaseCapture():(document.removeEventListener("mousemove",c,!1),document.removeEventListener("mouseup",c,!1))))}}}var d={};r&&window.setInterval(function(){var e=!1,n="Current pointerId array contains:";for(var t in d)e=!0,n+=" "+t;e&&r(n)},1e3);var f=u(e),v=!1;window.navigator.msPointerEnabled?(e.addEventListener("MSPointerDown",c,!1),e.addEventListener("MSPointerMove",c,!1),e.addEventListener("MSPointerUp",c,!1),e.addEventListener("MSPointerCancel",c,!1),"undefined"!=typeof e.style.msContentZooming&&(e.style.msContentZooming="none"),"undefined"!=typeof e.style.msTouchAction&&(e.style.msTouchAction="none"),r&&r("Using Microsoft pointer model")):e.addEventListener?(e.addEventListener("touchstart",c,!1),e.addEventListener("touchmove",c,!1),e.addEventListener("touchend",c,!1),e.addEventListener("touchcancel",c,!1),e.addEventListener("mousedown",c,!1),e.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(v=!0,e.addEventListener("mousemove",c,!1),e.addEventListener("mouseup",c,!1),r&&r("Using mouse model with capture"))):e.attachEvent&&e.setCapture?(v=!0,e.attachEvent("onmousedown",function(){return c(window.event),window.event.returnValue=!1,!1}),e.attachEvent("onmousemove",function(){return c(window.event),window.event.returnValue=!1,!1}),e.attachEvent("onmouseup",function(){return c(window.event),window.event.returnValue=!1,!1}),r&&r("Using legacy IE mode - mouse model with capture")):r&&r("Unexpected combination of supported features")}angular.module("angular-ranger",[]).directive("angularRanger",["$window",function(e){return{restrict:"E",replace:!0,templateUrl:"angular-ranger.html",scope:{min:"@",max:"@",step:"@",minValue:"=?",maxValue:"=?",value:"=?"},link:function(n,t,a){function r(e){if(b)return"max";var n=Math.abs(e-M.min),t=Math.abs(e-M.max);return n==t?e<M.min?"min":"max":n<t?"min":"max"}function i(e,t){w=Math.abs(n.min-n.max),v()}function o(e,n){E=parseFloat(e||1)}function u(e,n){P=e!==!1||"false"!==e}function m(){var e=L/y,t=e*w+parseFloat(n.min);return Math.round(t/E)*E}function l(){var e=m();n[V+"Value"]=e,b&&(n.value=e),M[V]=Math.abs(n.min-e)/w*h.clientWidth,n.$apply()}function s(){"min"==V&&L>M.max&&(L=M.max),"min"==V&&L<0&&(L=0),"max"==V&&L<M.min&&(L=M.min),"max"==V&&L>y&&(L=y)}function c(){L&&(s(),M[V]=L,g[V].attr("marker-value",m()),d())}function d(){null!=V&&null!=g[V]&&(g[V].css("left",M[V]+"px"),"min"==V?x.css("left",M.min+"px"):x.css("right",y-M.max+"px"))}function f(){var e={min:Math.abs(b?0:n.min-n.minValue)/w*100,max:Math.abs(n.min-(b?n.value:n.maxValue))/w*100};g.min.css("left",e.min+"%"),g.max.css("left",e.max+"%"),x.css({left:e.min+"%",right:100-e.max+"%"})}function v(){p(),f()}function p(){y=h.clientWidth;var e=n.minValue||n.min||0,t=n.maxValue||n.max||0;n.max<(b?n.value:n.maxValue)&&(n[b?"value":"maxValue"]=n.max),n.min>(b?n.value:n.minValue)&&(n[b?"value":"minValue"]=n.min),M.min=Math.abs(n.min-e)/w*h.clientWidth,M.max=Math.abs(n.min-t)/w*h.clientWidth}var h=t[0].querySelector(".ranger-scale"),g={min:angular.element(h.children[0]),max:angular.element(h.children[2])},x=angular.element(h.children[1]),w=Math.abs(n.min-n.max),y=h.clientWidth,E=parseFloat(n.step)||1,M={min:0,max:h.clientWidth},b=null==n.minValue,L=null,V=null,P=!1,$=null;b&&g.min.css("display","none"),angular.element(e).bind("resize",function(){p(),d(),n.$apply()}),n.$watch("min",i),n.$watch("max",i),n.$watch("minValue",v),n.$watch("maxValue",v),n.$watch("value",v),n.$watch("step",o),a.$observe("disabled",u),PointerDraw(h,function(e,n,t,a,i){P||(y<1&&p(),V=r(t),g[V][0].focus(),L=t,c())},function(e,n,t,a,r){P||(L=t,cancelAnimationFrame($),$=requestAnimationFrame(c))},function(e,n,t){P||(g[V][0].blur(),s(),l(),cancelAnimationFrame($))})}}}]),angular.module("angular-ranger").run(["$templateCache",function(e){e.put("angular-ranger.html",'<div class="ranger">\r\n\t<div class="ranger-scale">\r\n\t\t<div class="ranger-marker" tabindex="0" marker-value="0"></div>\r\n\t\t<div class="ranger-fill"></div>\r\n\t\t<div class="ranger-marker" tabindex="0" marker-value="100"></div>\r\n\t</div>\r\n</div>')}]);